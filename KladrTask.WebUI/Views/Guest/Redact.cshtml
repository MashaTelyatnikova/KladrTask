@model KladrTask.WebUI.Models.UserViewModel

@{
    ViewBag.Title = "Redact";
    Layout = "~/Views/Shared/_Main.cshtml";
}

<script src="../../Scripts/jquery-2.1.3.js" type="text/javascript"></script>
<script src="../../Scripts/jquery-2.1.3.min.js" type="text/javascript"></script>

<script type="text/javascript">
    $(document).ready(function () {
        $("#regions").change(function () {
            $("#localities").empty();
            $.ajax({
                type: 'POST',
                url: '@Url.Action("GetLocalities", "Account")',

                dataType: 'json',

                data: { id: $("#regions").val() },

                success: function (localities) {

                    $.each(localities, function (i, locality) {
                        $("#localities").append('<option value="' + locality.Value + '">' +
                            locality.Text + '</option>');

                    });
                },
                error: function (ex) {
                    alert('Failed to retrieve states.' + ex);
                }
            });
            return false;
        })
    });
</script>

<script type="text/javascript">
    $(document).ready(function () {
        $("#localities").change(function () {
            $("#streets").empty();
            $.ajax({
                type: 'POST',
                url: '@Url.Action("GetStreets", "Account")',
                dataType: 'json',
                data: { id: $("#localities").val() },
                success: function (streets) {
                    $.each(streets, function (i, street) {
                        $("#streets").append('<option value="'
                            + street.Value + '">'
                            + street.Text + '</option>');
                    });
                },
                error: function (ex) {
                    alert('Failed to retrieve states.' + ex);
                }
            });
            return false;
        })
    });
</script>

<script type="text/javascript">
    $(document).ready(function () {
        $("#streets").change(function () {
            $("#houses").empty();
            $.ajax({
                type: 'POST',
                url: '@Url.Action("GetHouses", "Account")',
                dataType: 'json',
                data: { id: $("#streets").val() },
                success: function (houses) {
                    $.each(houses, function (i, house) {
                        $("#houses").append('<option value="'
                            + house.Value + '">'
                            + house.Text + '</option>');
                    });
                },
                error: function (ex) {
                    alert('Failed to retrieve states.' + ex);
                }
            });
            return false;
        })
    });
</script>

@using (Html.BeginForm())
{
    @Html.ValidationSummary()
    <label>Логин:</label>
    @Html.TextBoxFor(m => m.Login, new {@Value = ViewData["login"]})
    <br />
    <label>Пароль:</label>
    @Html.PasswordFor(m => m.Password, new {@Value = ViewData["password"]})
    <br />
    <label>Имя</label>
    @Html.TextBoxFor(m => m.FirstName, new {@Value = ViewData["firstName"]})
    <br />
    <label>Фамилия</label>
    @Html.TextBoxFor(m => m.LastName, new { @Value = ViewData["lastName"] })
    <br />
    <label>Дата рождения</label>
    @Html.TextBoxFor(m => m.Birthday, new {@Value = ViewData["birthday"] })
    @Html.ValidationMessageFor(m => m.Birthday)
    <br />

    @Html.DropDownListFor(m => m.RegionCode, ViewData["regions"] as List<SelectListItem>, new { id = "regions", style = "width:250px", @class = "dropdown1" })
    <br />
    @Html.DropDownListFor(m => m.LocalityCode, ViewData["localities"] as List<SelectListItem>, new { id = "localities", style = "width:250px", @class = "dropdown1" })
    <br />
    @Html.DropDownListFor(m => m.RoadCode, ViewData["roads"] as List<SelectListItem>, new { id = "streets", style = "width:250px", @class = "dropdown1" })
    <br />
    @Html.DropDownListFor(m => m.HouseCode, ViewData["houses"] as List<SelectListItem>, new { id = "houses", style = "width:250px", @class = "dropdown1" })
    <br />
    <div id="lower">
        <input type="submit" value="OK"/>
    </div>
    
   
}
