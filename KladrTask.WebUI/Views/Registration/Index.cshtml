@{
    ViewBag.Title = "LoadCountries";
}

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link rel="stylesheet" href="~/Content/reset.css">
    <link rel="stylesheet" href="~/Content/animate.css">
    <link rel="stylesheet" href="~/Content/styles.css">
    <link rel="icon" href="http://vladmaxi.net/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="http://vladmaxi.net/favicon.ico" type="image/x-icon">
</head>
<body>


    <script src="../../Scripts/jquery-2.1.3.js" type="text/javascript"></script>
    <script src="../../Scripts/jquery-2.1.3.min.js" type="text/javascript"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            $("#regions").change(function () {
                $("#localities").empty();
                $.ajax({
                    type: 'POST',
                    url: '@Url.Action("GetLocalities")',

                    dataType: 'json',

                    data: { id: $("#regions").val() },

                    success: function (localities) {

                        $.each(localities, function (i, locality) {
                            $("#localities").append('<option value="' + locality.Value + '">' +
                                locality.Text + '</option>');

                        });
                    },
                    error: function (ex) {
                        alert('Failed to retrieve states.' + ex);
                    }
                });
                return false;
            })
        });
    </script>

    <script type="text/javascript">
        $(document).ready(function () {
            $("#localities").change(function () {
                $("#streets").empty();
                $.ajax({
                    type: 'POST',
                    url: '@Url.Action("GetStreets")',
                    dataType: 'json',
                    data: { id: $("#localities").val() },
                    success: function (streets) {
                        $.each(streets, function (i, street) {
                            $("#streets").append('<option value="'
                                + street.Value + '">'
                                + street.Text + '</option>');
                        });
                    },
                    error: function (ex) {
                        alert('Failed to retrieve states.' + ex);
                    }
                });
                return false;
            })
        });
    </script>

    <script type="text/javascript">
        $(document).ready(function () {
            $("#streets").change(function () {
                $("#houses").empty();
                $.ajax({
                    type: 'POST',
                    url: '@Url.Action("GetHouses")',
                    dataType: 'json',
                    data: { id: $("#streets").val() },
                    success: function (houses) {
                        $.each(houses, function (i, house) {
                            $("#houses").append('<option value="'
                                + house.Value + '">'
                                + house.Text + '</option>');
                        });
                    },
                    error: function (ex) {
                        alert('Failed to retrieve states.' + ex);
                    }
                });
                return false;
            })
        });
    </script>

    <div id="container">
        @using (Html.BeginForm("Show", "Address"))
        {
            @Html.DropDownList("regions", ViewData["regions"] as List<SelectListItem>, "Выберете регион", new { style = "width:250px", @class = "dropdown1" })
            @Html.DropDownList("localities", new SelectList(string.Empty, "Value", "Text"), "Выберете населенный пункт", new { style = "width:250px", @class = "dropdown1" })
            @Html.DropDownList("streets", new SelectList(string.Empty, "Value", "Text"), "Выберете улицу", new { style = "width:250px", @class = "dropdown1" })
            @Html.DropDownList("houses", new SelectList(string.Empty, "Value", "Text"), "Выберете дом", new { style = "width:250px", @class = "dropdown1" })
            <div id="lower">
                <input type="submit" value="OK" />
            </div>
        }
    </div>
</body>